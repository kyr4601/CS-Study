# 웹 통신 전체 흐름
<img src="https://lamarr.dev/images/basicnetworking/network-049.jpg" width="700" height="400">

1. 사용자의 통신 요청 

    이용자는 웹 브라우저를 통해 구글의 웹페이지를 요청하고, 이 과정은 애플리케이션 계층에서 시작된다. 여기서 HTTP, HTTPS와 같은 프로토콜이 사용되며, 이용자의 요청 정보가 생성된다.

2. DNS 해석 

    이용자의 컴퓨터는 구글의 도메인 이름을 IP 주소로 변환하기 위해 DNS 서버를 조회한다. 이 과정에서 이용자의 컴퓨터는 DNS Query를 생성하고 이를 DNS 서버에게 전송한다. DNS 서버는 이 Query를 해석하여 해당 도메인의 IP 주소를 반환한다.

3. TCP 연결 

    HTTPS는 TCP 프로토콜을 사용하므로, 이용자의 컴퓨터와 구글 서버 사이에는 TCP 연결이 설정된다. 이 과정에서는 3-way-handshake라는 절차가 이루어져 연결이 확립된다.

4. 데이터 캡슐화 

    응용계층에서 html 데이터 요청을 http 메세지에 담아서 보낸다.

    전송계층에서 이 메세지에 tcp 헤더를 붙인다. 여기에는 출발포트번호, 목적지포트번호, 시퀀스 번호등이 있다.

    네트워크 계층에서는 출발지와 목적지IP 주소 정보가 담겨있는 IP헤더가 붙는다.

    데이터 링크 계층에서는 이더넷 헤더와 트레일러가 추가된다. 이더넷 헤더에는 목적지, 출발지 MAC 주소가 있고, 트레일러에는 데이터의 무결성을 확인하는 오류 검출 코드가 있다.

5. 스위치에서의 처리 

    데이터 패킷은 스위치에 도착하면 역캡슐화되고, 이더넷 헤더에 기록된 목적지 MAC 주소를 바탕으로 다음 목적지를 결정한다. 스위치는 자신의 MAC 주소 테이블을 참조하여 이를 결정하며, 데이터 패킷은 다시 캡슐화되어 라우터로 전송된다.

6. 라우터에서의 처리 

    라우터에서는 데이터 패킷을 역캡슐화하고, IP 헤더에 기록된 목적지 IP 주소를 바탕으로 다음 목적지를 결정한다. 라우터는 자신의 라우팅 테이블을 참조하여 이를 결정하며, 필요에 따라 출발지 IP를 라우터의 공인 IP로 변경할 수 있다. 데이터 패킷은 다시 캡슐화되어 다음 목적지로 전송된다.

7. 서버에서의 처리 

    데이터 패킷이 최종 목적지인 서버에 도착하면, 서버는 패킷을 역캡슐화하고 각 계층에서 필요한 처리를 수행한다. 이 과정에서는 패킷의 무결성 검사, 전송 오류 확인 등 다양한 작업이 이루어진다. 

8. 애플리케이션 계층에서 이용자의 웹페이지 요청을 처리하고 응답을 생성하여 이용자에게 전송한다.


<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fnz2Lp%2FbtqL8WD1lTY%2FboQNryZcUl7jkckCHMbUB0%2Fimg.png" width="700" height="400">
